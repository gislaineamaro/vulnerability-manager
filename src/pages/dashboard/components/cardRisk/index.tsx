import React, { useEffect, useState } from 'react'
import axios from 'axios'

import { ICardRisk } from '../../types'
import Card from '../../../../components/card/index'

const CardRisk = () => {
  const [listRisk, setListRisk] = useState<ICardRisk>()

  useEffect(() => {
    getAssetsRisk()
  }, [])

  const getAssetsRisk = () => {
    let acessToken = localStorage.getItem('token')

    axios
      .get('http://201.49.62.134:8080/api/dashboard/cards/risk', {
        headers: {
          Authorization: 'Token ' + acessToken
        }
      })
      .then(Response => {
        setListRisk(Response.data)
      })
      .catch(e => {
        console.log('error')
      })
  }
  return (
    <Card
      data={{
        labels: [],
        datasets: [
          {
            data: [listRisk?.risk_avg || 0, 100],
            backgroundColor: ['#ff6385a2', '#36a3ebab']
          }
        ]
      }}
      value={listRisk?.risk_avg}
      label="Risco de Vulnerabilidade"
    />
  )
}

export default CardRisk
