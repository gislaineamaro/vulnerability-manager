import React, { useEffect, useState } from 'react'
import axios from 'axios'

import { ICardAsset } from '../../types'
import Card from '../../../../components/card/index'

const CardActives = () => {
  const [listAssets, setListAssets] = useState<ICardAsset>()

  useEffect(() => {
    getAssetsVuln()
  }, [])

  const getAssetsVuln = () => {
    let acessToken = localStorage.getItem('token')

    axios
      .get(`${process.env.REACT_APP_API_URL}/api/dashboard/cards/asset`, {
        headers: {
          Authorization: 'Token ' + acessToken
        }
      })
      .then(Response => {
        setListAssets(Response.data)
      })
      .catch(e => {
        console.log('error')
      })
  }
  return (
    <Card
      data={{
        labels: [],
        datasets: [
          {
            data: [listAssets?.vulnerable_asset_count || 0, 0],
            backgroundColor: ['#ff6385a2', '#36a3ebab']
          }
        ]
      }}
      value={`${listAssets?.vulnerable_asset_count} / ${listAssets?.asset_count}`}
      label="Maquinas VulneravÃ©is"
    />
  )
}

export default CardActives
