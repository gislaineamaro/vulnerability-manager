import React, { useEffect, useState } from 'react'
import axios from 'axios'

import { ICardVulnerabilities } from '../../types'
import Card from '../../../../components/card/index'

const CardVulnerabilities = () => {
  const [listVuln, setListVuln] = useState<ICardVulnerabilities>()

  useEffect(() => {
    getVuln()
  }, [])

  const getVuln = () => {
    let acessToken = localStorage.getItem('token')

    axios
      .get(
        `${process.env.REACT_APP_API_URL}/api/dashboard/cards/vulnerability`,
        {
          headers: {
            Authorization: 'Token ' + acessToken
          }
        }
      )
      .then(Response => {
        setListVuln(Response.data)
      })
      .catch(e => {
        console.log('error')
      })
  }
  return (
    <Card
      data={{
        labels: [],
        datasets: [
          {
            data: [listVuln?.active_vuln_count || 0, listVuln?.vuln_count || 0],
            backgroundColor: ['#ff6385a2', '#36a3ebab']
          }
        ]
      }}
      value={listVuln?.active_vuln_count}
      label="Vulnerabilidades Ativas"
    />
  )
}

export default CardVulnerabilities
